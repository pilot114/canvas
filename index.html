<!DOCTYPE html>
<html>
<head>
	<title>flat world</title>
</head>
<body>
	<div>
		<h1>info:</h1>
		<div id="info"></div>
	</div>
	<canvas id="canvas" style="width: 1400px; height: 700px; background-color: #ddd;"></canvas>
</body>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="./Helpers.js"></script>
<script type="text/javascript" src="./Animation.js"></script>
<script type="text/javascript" src="./Behavior.js"></script>
<script type="text/javascript" src="./Lifers.js"></script>
<script type="text/javascript" src="./World.js"></script>
<script type="text/javascript">

function onLoadHandler() {
	// подготавливаем канвас
	var canvas = document.getElementById('canvas');
	var context = canvas.getContext('2d');
	canvas.width = 1400;
	canvas.height = 700;

	var fps = 60;

	// генерим начальное состояние
	var world = new World(canvas.width, canvas.height);
	createLifers(world, "Wolf", 10);
	createLifers(world, "Cow", 60);
	createLifers(world, "Grass", 100);

	// рендерим, используя requestAnimationFrame
	var now;
	var start = Date.now();
	var then = Date.now();
	var interval = 1000/fps;
	var delta;

	// "шаг" обработки мира
	var step = function(now) {
		context.clearRect(0, 0, canvas.width, canvas.height);
		world.update(now);
		world.draw(context);

		// можно добавлять объекты динамически
		createLifers(world, "Grass", 1);

        $('#info').text(JSON.stringify(world.getCounts()));
	};
	function draw() {
	    requestAnimationFrame(draw);
	    now = Date.now();
	    delta = now - then;
	     
	    if (delta > interval) {
	        then = now - (delta % interval);
	        step(now-start);
	    }
	}
	draw();
}

window.onload = onLoadHandler;

</script>
</html>